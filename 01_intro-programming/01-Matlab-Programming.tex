\documentclass[11pt,table,final,fleqn,xcolor={usenames,dvipsnames},unknownkeysallowed,handout]{beamer}
\usetheme[]{Frankfurt}
% \usecolortheme{crane}

\input{../00-settings.tex}

% PRESENTATION SPECIFICS
\title{Matlab and Programming}
\subtitle{Programming basics and algorithms}

\author[I.~Roghair]{\underline{Ivo~Roghair}, Martin van Sint Annaland}

\institute{Chemical Process Intensification\\Eindhoven University of Technology}

\date

% BEGIN PRESENTATION
\begin{document}
\input{../lstsettings.tex}

\frame[plain]{
  \titlepage
}

\part{Matlab introduction}
\begin{frame}
    \partpage
\end{frame}

\section{Introduction}
\subsection*{Introduction}
\begin{frame}[label=contents]
  \frametitle{Today's outline}
  \mode<beamer>{
    \only<1>{\tableofcontents}
  }
  \only<2>{\tableofcontents[currentsection]}
\end{frame}

\begin{frame}[t]
 \frametitle{Programming}
 \vskip1em
   \tikzstyle{every picture}-=[remember picture]
  {\LARGE \vspace{-1em}``Everybody in this country should learn to program a computer, because it teaches you to think..''\\
   {\vspace{1em}\hspace{10em} ---Steve Jobs}}
   \begin{tikzpicture}[remember picture,overlay]{
    \node[xshift=-0.2cm,yshift=-0.2cm, anchor=south west] at (current page.south west) {\includegraphics[width=0.4\textwidth]{img/jobs.png}};}
   \end{tikzpicture}
\end{frame}

\begin{frame}
 \frametitle{Why?}
 \begin{itemize}[<+->]
  \item Scientific techniques depend in an increasing fashion upon computer programs and simulation methods
  \item Knowledge of programming allows you to automate routine tasks 
  \item Ability to understand algorithms by inspection of the code 
  \item Learn to think by dissecting a problem into smaller bits 
 \end{itemize}\vskip2em
 \begin{columns}
  \column<1->{0.23\textwidth}
  \tikz\node[circle,draw,very thick,maincolor,
           text=white,minimum size=\columnwidth,
           path picture={
               \node at (path picture bounding box.center){
                   \includegraphics[width=\columnwidth]{img/sim1.png}
               };
           }]{};
  \column<2->{0.23\textwidth}
  \tikz\node[circle,draw,very thick,maincolor,
           text=white,minimum size=\columnwidth,
           path picture={
               \node at (path picture bounding box.center){
                   \includegraphics[width=1.1\columnwidth]{img/automate.jpg}
               };
           }]{};
  \column<3->{0.23\textwidth}
  \tikz\node[circle,draw,very thick,maincolor,
           text=white,minimum size=\columnwidth,
           path picture={
               \node at (path picture bounding box.center){
                   \includegraphics[width=1.2\columnwidth]{img/algorithm.jpg}
               };
           }]{};
  \column<4>{0.23\textwidth}
  \tikz\node[circle,draw,very thick,maincolor,
           text=white,minimum size=\columnwidth,
           path picture={
               \node at (path picture bounding box.center){
                   \includegraphics[width=1.5\columnwidth]{img/dissect.jpg}
               };
           }]{};
 \end{columns}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Getting started}
  Start Matlab, and enter the following commands on the command line. Evaluate the output.
  \pause
  \begin{lstlisting}
>> 2 + 3        % Some simple calculations
>> 2*3
>> 2*3^2        % Powers are done with ^ (*@ \pause @*)
>> a = 2        % Storing values into the workspace
>> b = 3
>> c = (2*3)^2  % Parentheses set priority
>> 8/a-b (*@ \pause @*)
>> sin(a)       % Mathematical functions can be used 
>> sin(0.5*pi)  % pi is an internal Matlab variable
>> 1/0          % Infinity is a thing ...
>> sqrt(-1)     % ... as are imaginary numbers
  \end{lstlisting}
\end{frame}

\begin{frame}
 \frametitle{Introduction to programming}
 \begin{block}{What is a program?}
  \emph{A program is a sequence of instructions that is written to perform a certain task on a computer.} % SOURCE http://www.greenteapress.com/thinkpython/html/thinkpython002.html
  \end{block}
  \begin{itemize}
    \item The computation might be something mathematical, a symbolic operation, image analysis, etc.%such as solving a system of equations or finding the roots of a polynomial
    % \item It can also be a symbolic computation, such as searching and replacing text in a document 
    % \item A program may even be used to compile another program
    % \item A program consists of one or more \emph{algorithms}
  \end{itemize}
  \begin{block}{Program layout}
    \begin{enumerate}
        \item Input (Get the radius of a circle)
        \item Operations (Compute and store the area of the circle)
        \item Output (Print the area to the screen)
    \end{enumerate}
  \end{block}
\end{frame}

% \begin{frame}
%  \frametitle{Getting started}
%  \begin{itemize}
%    \item Use an \emph{integrated development environment}
%    \begin{itemize}
%      \item Matlab
%      \item MS Visual Studio/Code
%      \item Eclipse
%      \item Dev C++
%      \item IDLE, Canopy (express)
%    \end{itemize}
%    \item Create a simple program:
%    \begin{itemize}
%      \item Hello world
%      \item Find the roots of a parabola
%      \item Find the greatest common divisor of two numbers
%    \end{itemize}
%  \end{itemize}
% \end{frame}

% \begin{frame}
%  \frametitle{Some often used programming languages}
%  \fontsize{7.2pt}{7.2}\selectfont
%  \begin{columns}[T]
%    \column{0.45\textwidth}
%    \begin{block}<1->{Python}
%      \begin{itemize}
%        \item Many functionalities available
%        \item Smooth learning curve
%        \item Slow compared to compiled languages
%        \item Many freely available editors
%      \end{itemize}
%    \end{block}
%     \begin{block}<2->{Pascal}
%      \begin{itemize}
%        \item Limited number of libraries available
%        \item Steep learning curve
%        \item Compiled language, may be fast
%        \item Some free compilers (fpc)
%      \end{itemize}
%    \end{block}
%    \column{0.45\textwidth}
%    \begin{block}<3->{C / C++ / C\#}
%      \begin{itemize}
%        \item Many functionalities available 
%        \item Steeper learning curve
%        \item Needs compilation, very fast (HPC)
%        \item Freely available (gcc, MSVC)
%      \end{itemize}
%    \end{block}
%    \begin{block}<4->{Spreadsheet (Excel, Google Docs, ...)}
%      \begin{itemize}
%        \item High availability
%        \item Low learning curve
%        \item Very limited for larger problems, unbeatable for quick calculations
%        \item Not always free
%      \end{itemize}
%    \end{block}
%  \end{columns}
%     \begin{block}<5>{Matlab}
%      \begin{columns}[T]
%      \column{0.5\textwidth}
%      \begin{itemize}
%        \item Many functionalities built-in (80+ toolkits!)
%        \item Slow compared to compiled languages
%        \end{itemize}
%        \column{0.5\textwidth}
%        \begin{itemize}
%        \item Fairly smooth learning curve
%        \item Needs a license (alternatives: SciLab, GNU Octave)
%      \end{itemize}
%      \end{columns}
%    \end{block}
% \end{frame}

\begin{frame}
\frametitle{Versatility of Matlab}
\includegraphics[width=\textwidth]{matlab.png}
\end{frame}

\begin{frame}
\frametitle{Versatility of Matlab: ODE solver}
\includegraphics[width=\textwidth]{odesol.png}
\end{frame}

\begin{frame}[fragile]
\frametitle{Versatility of Matlab: Image analysis}
\begin{columns}
  \column{0.5\textwidth}
\begin{lstlisting}
I = imread('bubbles.png');
BW = rgb2gray(I);
E = edge(BW, 'canny');
F = imfill(E, 'holes');
result = regionprops(F);
\end{lstlisting}  
\column{0.5\textwidth}
  \vfill
  \includegraphics<1>[width=\columnwidth]{bub1.png}
  \includegraphics<2>[width=\columnwidth]{bub2.png}
  \includegraphics<3>[width=\columnwidth]{bub3.png}
  \includegraphics<4>[width=\columnwidth]{bub4.png}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Versatility of Matlab: Curve fitting}
\includegraphics[width=\textwidth]{cftool.png}
\end{frame}

\begin{frame}
\frametitle{Matlab help}
\begin{itemize}[<+->]
  \item Matlab documentation: \lstinline$doc$ or \lstinline$help$ function
  \item Canvas page
  \item Introduction to Numerical Methods and Matlab Programming for Engineers. T. Young and M.J. Mohlenkamp (2015). GNU-licensed document, online
%   \item Interactive Matlab Course. Pieter van Zutven (2010). See also \url{http://www.imc.tue.nl/}
  \item Search the web!
\end{itemize}
\vspace{-2em}
\flushright\tikz{\node[] at (4cm,-2cm) {\includegraphics[width=0.5\textwidth]{img/help.jpg}};}
\end{frame}
%
\section{Data structures}
\subsection*{Introduction}
\againframe<2>{contents}
\begin{frame}
 \frametitle{Terminology}
 \begin{description}
  \item[Variable] Piece of data stored in the computer memory, to be referenced and/or manipulated
  \item[Function] Piece of code that performs a certain operation/sequence of operations on given input
  \item[Operators] Mathematical operators (e.g. \lstinline$ + - *$ or \lstinline$/$), relational (e.g. \lstinline$< >$or \lstinline$==$, and logical operators (\lstinline$&&$, \lstinline$||$)
  \item[Script] Piece of code that performs a certain sequence of operations without specified input/output
  \item[Expression] A command that combines variables, functions, operators and/or values to produce a result.
 \end{description}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Variables in Matlab}
  \begin{itemize}
   \item Matlab stores variables in the \emph{workspace}\pause
   \item You should recognize the difference between the \emph{identifier} of a variable (its name, e.g. \lstinline$x$, \lstinline$setpoint_p$), and the data that it actually stores (e.g. 0.5)\pause
   \item Matlab also defines a number of variables by default, e.g. \lstinline$eps$, \lstinline$pi$ or \lstinline$i$.\pause
   \item You can assign a variable by the \lstinline$=$ sign:
   \begin{lstlisting}
>> x = 4*3
x =
    12
   \end{lstlisting}\pause
   \item If you don't assign a variable, it will be stored in \lstinline$ans$
   \item Clearing the workspace is done with \lstinline$clear$.
 \end{itemize}
\end{frame}

\begin{frame}[fragile]
    \frametitle{Datatypes and variables}
    Matlab uses different types of variables:
        \begin{longtable}{l!{\vrule}l}
         Datatype        & Example \\ \hline
         \texttt{string} & \lstinline$'Wednesday'$ \\
         \texttt{integer}& \lstinline$15$ \\
         \texttt{float}  & \lstinline$0.15$ \\
         \texttt{vector} & \lstinline$[0.0; 0.1; 0.2]$ \\
         \texttt{matrix} & \lstinline$[0.0 0.1 0.2; 0.3 0.4 0.5]$ \\
         \texttt{struct} & \lstinline$sct.name = 'MyDataName'$ \\
                         & \lstinline$sct.number = 13$ \\
         \texttt{logical}& \lstinline$0$ (false)  \\
                         & \lstinline$1$ (true) \\
       \end{longtable}
   \end{frame}
   
   \begin{frame}[fragile]
    \frametitle{About variables}
    \begin{itemize}
      \item Matlab variables can change their type as the program proceeds (this is not common for other programming languages!):
      \begin{lstlisting}
   >> s = 'This is a string'
   s =
   This is a string
   >> s = 10
   s =
       10
   \end{lstlisting}
       \item Vectors and matrices are essentially \emph{arrays} of another data type. A vector of \lstinline$struct$ is therefore possible.
       \item Variables are \emph{local} to a function (more on this later).
   \end{itemize}
   \end{frame}

\subsection*{Vectors}
\begin{frame}[fragile]
  \frametitle{Vectors in Matlab (1)}
  A row vector:
  \begin{lstlisting}
>> v = [0 1 2 3]
  \end{lstlisting}\pause
  A column vector by separating elements with semi-colons:
  \begin{lstlisting}
>> u = [9; 10; 11; 12; 13; 14; 15]
  \end{lstlisting}\pause
  Access (i.e. read) an entry in a vector:
  \begin{lstlisting}
>> u(2)
  \end{lstlisting}\pause
  Manipulate the value of that entry:
  \begin{lstlisting}
>> u(2)=47
  \end{lstlisting}\pause
  Get a slice of a vector:
  \begin{lstlisting}
>> u([2 3 4]) % With colon operator: u(2:4)
  \end{lstlisting}\pause
  Transposing vectors:
  \begin{lstlisting}
>> w = v'
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Vectors in Matlab (2)}
  Manual definition may be cumbersome. A colon (\lstinline$:$) generates a list:
  \begin{lstlisting}
>> a = 1:10      % Default stride is 1
>> x = -1:.1:1   % start:stride:stop specifies list
  \end{lstlisting}\pause
  Or, when you prefer to set the \emph{number of elements} instead of the step size:
  \begin{lstlisting}
>> y = linspace(0,10,11)
>> p = logspace(2,6,5)
  \end{lstlisting}\pause
  Manipulating multiple components:
  \begin{lstlisting}
>> y([1 4:7]) = 1
  \end{lstlisting}\pause
  Or (by supplying a vector instead of a scalar):
  \begin{lstlisting}
>> y([1 4:7]) = 16:20 % equivalent to y([1 4 5 6 7]) = [16 17 18 19 20]
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Practice}
 Given a vector 
 \[ 
    x = \left[2 \ 4 \ 6 \ 8 \ 10 \ 12 \ 14 \ 16 \ 18 \ 20 \ 30 \ 40 \ 50 \ 60 \ 70 \ 80 \right]
 \]
 \begin{itemize}
  \item Find a way to define the vector without typing all individual elements\pause
  \item Investigate the meaning of the following commands:
  \begin{lstlisting}
>> y = x(5:end)
>> y(4)
>> y(4) = []
>> sum(x)
>> mean(x)
>> std(x)
>> max(x)
>> fliplr(x)
>> diff(x)
  \end{lstlisting}
 \end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Operations on vectors (1)}
  \begin{lstlisting}
>> e = 1:5
>> f = 2*e
>> g = 4*f + 20 (*@ \pause @*)
>> h = e^2
  \end{lstlisting}\pause
  ... wait ... what's that?
  \begin{lstlisting}[basicstyle=\color{red}\footnotesize\ttfamily,keywordstyle={\color{red}}, identifierstyle=\color{red}]
Error using  ^ 
Inputs must be a scalar and a square matrix.
To compute elementwise POWER, use POWER (.^) instead.
  \end{lstlisting}\pause
  Matlab uses matrix operations by default, we should use a dot operator to make operations element-wise for \lstinline$*$, \lstinline$/$ and \lstinline$^$.
  \begin{lstlisting}
>> e.^2
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Operations on vectors (2)}
   To demonstrate the matrix product:
  \begin{lstlisting}
>> p = [1; 1; 1]
>> q = [1 2 3]
>> p*q   % which is not equal to q*p
  \end{lstlisting}\pause
  All kinds of mathematical functions on vectors typically operate on elements:
  \begin{lstlisting}
>> x = linspace(0,2*pi,100);
>> s = sin(x)
>> e = exp(x)
  \end{lstlisting}
\end{frame}

\begin{frame}
 \frametitle{Building blocks: Mathematics and number manipulation}
 Programming languages usually support the use of various mathematical functions (sometimes via a specialized library). Some examples of the most elementary functions in Matlab:
    \begin{longtable}{l!{\vrule}l}
      Command        & Explanation \\ \hline
      \texttt{cos(x), sin(x), tan(x)} & Cosine, sine or tangens of $x$ \\
      \texttt{mean(x), std(x)} & Mean, st. deviation of vector $x$ \\
      \texttt{exp(x)} & Value of the exponential function $e^x$ \\
      \texttt{log10(x), log(x)} & Base-10/Natural logarithm of $x$ \\
      \texttt{floor(x)} & Largest integer smaller than $x$ \\
      \texttt{ceil(x)} & Smallest integer that exceeds $x$ \\
      \texttt{abs(x)} & Absolute value of $x$ \\
      \texttt{size(x)} & Size of a vector $x$ \\
      \texttt{length(x)} & Number of elements in a vector $x$ \\
      \texttt{rem(x,y)} & Remainder of division of $x$ by $y$\\
    \end{longtable}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Printing results}
  You can prevent displaying the outcome of a command by adding a semi-colon at the end of a line:
  \begin{lstlisting}
>> c = linspace(0,10,11);
>> length(c)
>> c
>> size(c)
  \end{lstlisting}\pause
  Altering the display format can be done using the \lstinline$format$ command:
  \begin{lstlisting}
>> format compact % loose
>> format long    % short
  \end{lstlisting}
\end{frame}

\section{Plotting}
\subsection*{Simple plotting}
\begin{frame}[fragile]
  \frametitle{Simple plotting}
  Make a plot of the following table
   \begin{longtable}{l!{\vrule}ccccc}
%    \rowcolors[]{1}{maincolor!20}{maincolor!10}
      T ($^\circ$C) & 5   &  20  & 30   & 50   & 55 \\
      $\mu$ (Pa$\cdot$s)  & 0.08& 0.015& 0.009& 0.006& 0.0055 \\
    \end{longtable} \pause
  \begin{lstlisting}
>> T = [ 5 20 30 50 55 ]
>> mu = [ 0.08 0.015 0.009 0.006 0.0055]
\end{lstlisting}
\begin{onlyenv}<1-2>
  \begin{lstlisting}
>> plot(T,mu)
  \end{lstlisting}
\end{onlyenv}
\begin{onlyenv}<3>
  \begin{lstlisting}
>> plot(T,mu,'*')
  \end{lstlisting}
\end{onlyenv}
\begin{onlyenv}<4>
  \begin{lstlisting}
>> plot(T,mu,'r--')
  \end{lstlisting}
\end{onlyenv}
\begin{onlyenv}<5>
  \begin{lstlisting}
>> plot(T,mu,'ko-','LineWidth',2)
  \end{lstlisting}
\end{onlyenv}
\begin{lstlisting}
>> xlabel('Temperature [^\circC]')
>> ylabel('Viscosity [Pa s]')
>> title('Experiment 1')
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Practice}
 Create plots of the following functions in a single figure for $x \in \left\{0,2\pi\right\}$:
  \[
    y_1 = \cos x 
  \]
  \[
    y_2 = \arctan x 
  \]
  \[
    y_3 = \frac{\sin x }{x}
  \]
  \pause
  Strategies to draw multiple graphs in 1 figure:
 \begin{lstlisting}
>> plot(x,y1,x,y2,x,y3)
 \end{lstlisting}
  \begin{lstlisting}
>> plot(x,y1)
>> hold on; % Maintain drawn plots in current figure
>> plot(x,y2)
>> plot(x,y3) % The 'hold-property' was already set
  \end{lstlisting}
\end{frame}

\subsection*{Matrices}
\begin{frame}[fragile]
  \frametitle{Matrices in Matlab}
  \begin{columns}[T]
   \column{0.35\textwidth}
    Matrix A is defined as:
    \[
    A = \begin{bmatrix}
      8 & 1 & 6 \\
      3 & 5 & 7 \\
      4 & 9 & 2
    \end{bmatrix}\]
    \pause
    \column{0.65\textwidth}
    In Matlab:
  \begin{lstlisting}
>> A = [ 8 1 6; 3 5 7; 4 9 2]
  \end{lstlisting}
  \end{columns}
  \pause
  Elements can be accessed/manipulated by the following syntax:
  \begin{lstlisting}
>> A(3,1) % Third row, first column, also A(3)
>> A(3,:) = [2 4 8] % Set entire third row
>> A(:,3) % Print third column
>> A(A>5) = 2 % Set elements by condition
  \end{lstlisting}\pause
  There are a few functions that help creating matrices:
  \begin{lstlisting}
>> A = zeros(4)  % A 4x4 matrix with zeros
>> A = ones(4,1) % A 4-element vector with ones
>> A = eye(3)    % Identity matrix of 3x3
>> A = rand(3,4) % A 3x4 matrix with random numbers
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Practice}
 \begin{itemize}
  \item Find a \emph{short} Matlab expression to create the following matrix:
  \[
   A = \begin{bmatrix}
        1 & 2 & 3 & 4 & 5 & 6 & 7\\
        9 & 7 & 5 & 3 & 1 & -1 & -3 \\
        4 & 8 & 16 & 32 & 64 & 128 & 256 \\
       \end{bmatrix}
  \]\pause
  \item Investigate the command \lstinline$max(A)$. What does it give?
%   \item How to obtain the maximum for each row?
 \end{itemize}
\end{frame}



\section{Creating algorithms}
\subsection*{Control statements}
\againframe<2>{contents}
\begin{frame}[fragile]
 \frametitle{Building blocks: conditional statements}
  \lstinline$if$-statement: Check whether a (set of) condition(s) is met. \\ 
  \vskip1em \pause
  \begin{lstlisting}
num = floor (10 * rand + 1);
guess = input ('Your guess please : ');
if ( guess ~= num )
  disp (['Wrong, it was ',num2str(num),'. Kbye.']);
else
    disp ('Correct !') ;
end
  \end{lstlisting}
  \pause
  \begin{columns}[T]
    \column{0.5\textwidth}
    Other relational operators
      \begin{longtable}{l!{\vrule}l}
      \hline
      \lstinline$==$& is equal to \\ 
      \lstinline$<=$& is less than or equal to\\
      \lstinline$>=$&is  greater than or equal to\\
      \lstinline$<$& is less than \\
      \lstinline$>$& is greater than \\
      \hline
    \end{longtable}  
    \column{0.5\textwidth}
      Combining conditional statements
      \begin{longtable}{l!{\vrule}l}
      \hline
      \lstinline$&&$& and \\ 
      \lstinline$||$& or\\
      \lstinline$xor$& exclusive or\\
      \hline
    \end{longtable}  
  \end{columns}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Building blocks: loops}
  \lstinline$for$-loop: Performs a block of code a certain number of times. \\ 
  \vskip1em \pause
  \begin{lstlisting}
>> p(1) = 1;
>> p(2) = 1;
>> for i = 2:10
p(i+1) = p(i)+p(i-1);
end
>> p
p =
   1   1   2   3   5   8  13  21  34  55  89
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Building blocks: indeterminate repetition}
  \lstinline$while$-loop: Performs and repeats a block of code until a certain condition. \\ 
  \vskip1em \pause
  \begin{lstlisting}
num = floor (10* rand +1) ;
guess = input ('Your guess please : ');

while ( guess ~= num )
    guess = input ('That is wrong. Try again ... ');
end

if (isempty(guess))
    disp('No number supplied - exit');
else
    disp ('Correct!');
end
  \end{lstlisting}
\end{frame}

%%%% Example
\begin{frame}[fragile]
 \frametitle{Example algorithm}
 Compute the factorial of $N$: $N! = N\cdot(N-1)\cdot(N-2)\cdots 2\cdot 1$\\ \vskip1em
 How to deal with this? \vfill
 \begin{columns}[T]
   \column{0.3\textwidth}
   \begin{block}<2->{Naive approach}
       \begin{lstlisting}
Z = 1;
Z = Z*2;
Z = Z*3;
Z = Z*4;
... etc ...      
       \end{lstlisting}
   \end{block}
   \column{0.3\textwidth}
   \begin{block}<3->{For-loop}
       \begin{lstlisting}
Z = 1;
for i = 1:N
    Z = Z*i;
end
       \end{lstlisting}
   \end{block}
   \column{0.3\textwidth}
\begin{block}<4>{While-loop}
       \begin{lstlisting}
Z = 1;
i = 1;
while (i<=N)
    Z = Z*i;
    i = i+1;
end
       \end{lstlisting}
   \end{block}
 \end{columns}
 \onslide<4>{
   Note: \lstinline$N$ must be set beforehand!\\ 
   Note: Pay attention to the relational operators!  }
\end{frame}

\begin{frame}[fragile]
 \frametitle{Building blocks: case selection}
  \lstinline$switch$-statement: Selects and runs a block of code. \\ 
  \vskip1em \pause
  \begin{lstlisting}
[dnum,dnam] = weekday(now);
switch dnum
    case {1,7}
        disp('Yay! It is weekend!');
    case 6
        disp('Hooray! It is Friday!');
    case {2,3,4,5}
        disp(['Today is ' dnam]);
    otherwise
        disp('Today is not a good day...');
end
  \end{lstlisting}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Input and output}
 Many programs require some input to function correctly. A combination of the following is common:
 \begin{itemize}[<+->]
   \item Input may be given in a parameters file (``hard-coded'')
   \item Input may be entered via the keyboard
   \begin{lstlisting}
>> a = input('Please enter the number ');
   \end{lstlisting}
   \item Input may be read from a file, e.g.
    \begin{lstlisting}
>> data = getfield(importdata('myData.txt', ' ', 4), 'data');
>> numdata = xlsread('myExcelDataFile.xls');
   \end{lstlisting}
   \item There are many more advanced functions, e.g. \lstinline$fread$, \lstinline$fgets$, ...
 \end{itemize}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Input and output}
 Output of results to screen, storing arrays to a file or exporting a graphic are the most common ways of getting data out of Matlab:
 \begin{itemize}[<+->]
   \item Results of each expression are automatically shown on screen as long as the line is not ended with a semi-colon;
   \item Output may be stored via the GUI:
    \begin{itemize}
      \item Use the 'Export Setup' function
      \item Save figure (use .fig, .eps or .png, \textbf{not} .jpg or .pcx)
      \item Save variables (right click, save as)
    \end{itemize}
   \item Save variables automatically (scripted):
    \begin{lstlisting}
>> savefile = 'test.mat';
>> p = rand(1,10);
>> q = ones(10);
>> save(savefile,'p','q')
   \end{lstlisting}
   \item More advanced functions can be found in e.g.  \lstinline$fwrite$, \lstinline$fprintf$, ...
 \end{itemize}
\end{frame}

\section{Functions}
\subsection*{Introduction}
\againframe<2>{contents}
\begin{frame}[fragile]
 \frametitle{Functions - general}
 A function in a programming language is a program fragment that performs a certain task. Creating functions keeps your code clean, re-usable and structured.
 \begin{itemize}
   \colorize<2-> \item You can use functions supplied by the programming language, and define functions yourself
   \colorize<3-> \item Functions take one or more input parameters (\emph{arguments}), and \emph{return} an output (result).
   \begin{itemize}
     \colorize<3-> \item If functions do not return a result, it is called a procedure
   \end{itemize}
   \colorize<4-> \item In Matlab, functions are defined as follows (2 output variables and 3 input arguments):
  \begin{overlayarea}{\textwidth}{2em}
   \begin{onlyenv}<4>
    \begin{lstlisting}
function [out1, out2] = myFunction(in1, in2, in3)
    \end{lstlisting}
    \end{onlyenv}
   \end{overlayarea}
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Functions - locality and arguments}
 \begin{itemize}
   \item You are supplying arguments to a function because it does not have acces to previously defined variables. This is called \emph{locality}.
   \begin{itemize}
     \item This does not include global variables - but they're evil!
     \item Local variables created in a function are not accessible to other functions unless they are returned or supplied as an argument!
   \end{itemize}
 \end{itemize}
 \vskip1em \pause
 Example: write a function that takes 3 variables, and returns the average: \pause
  \begin{columns}[T]
   \column{0.5\textwidth}
   \begin{block}<2->{Approach 1}
 \begin{lstlisting}
function res = avg1(a,b,c)
    mySum = a + b + c;
    res = mySum / 3;
end \end{lstlisting}
   \end{block}
   \column{0.5\textwidth}
   \begin{block}<3->{Approach 2}
       \begin{lstlisting}
function res = avg2(a,b,c)
    data = [a; b; c];
    res = mean(data);
end \end{lstlisting}
   \end{block}
 \end{columns}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Exercise: create a function}
 Compute $N! = N\cdot(N-1)\cdot(N-2)\cdots 2\cdot 1$\\ \vskip1em
 Create a function of our while-loop approach with N the argument: \\
 
 \begin{columns}[T]
   \column{0.5\textwidth}
   \begin{block}{Original script}
	   \begin{lstlisting}
Z = 1;
i = 1;
while (i<=N)
    Z = Z*i;
    i = i+1;
end \end{lstlisting}
   \end{block}
   \column{0.5\textwidth}
   \begin{block}<2>{Function}
	   \begin{lstlisting}
function Z = fact_while(N)

Z = 1;
i = 1;
while (i<=N)
    Z = Z*i;
    i = i+1;
end

end\end{lstlisting}
   \end{block}
 \end{columns}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Functions - checking input}
  The function we created computes the factorial correctly! \pause
  \begin{itemize}
     \item When the supplied argument is positive\pause\ and \pause
     \item When the supplied argument is a natural number...
  \end{itemize}\pause
  \begin{columns}[T]
   \column{0.4\textwidth}
     \includegraphics[width=\columnwidth]{deadmau5.png}
   \column{0.6\textwidth}
    \pause
    \begin{itemize}[<+->]
     \item In this case, we should check the user input to prevent an infinite loop: \pause
     \begin{lstlisting} 
if (fix(N)~=N) | (N<0)
    disp 'Provide a positive integer number!'
    return;
end \end{lstlisting}
      \item If no check can be done before a while-loop, you may want to stop after $x$ loops
    \end{itemize}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Functions - checking input}
  The whole factorial function, including comments:
     \begin{lstlisting}
function Z = fact_while(N)
%% This function computes a factorial of input value N
% Usage  : fact_while(N)
% N      : value of which the factorial is computed
% returns: factorial of N

% Catch non-integer case
if (fix(N)~=N) | (N<0)
    disp 'Provide a positive integer number!'
    return;
end

Z = 1;
i = 1;
while (i<=N)
    Z = Z*i;
    i = i+1;
end

end \end{lstlisting}
\end{frame}

\begin{frame}[label=recursion,fragile]
 \frametitle{Recursion}
 \begin{columns}
   \column{0.5\textwidth}
   \begin{itemize}
    \item<1-> In order to understand recursion, one must first understand recursion
    \item<2-> A recursive function is called by itself (a function within a function)
    \begin{itemize}
      \item<3-> This could lead to infinite calls;
      \item<3-> A base case is required so that recursion is stopped;
      \item<3-> Base case does not call itself, simply returns.
    \end{itemize}
 \end{itemize}
   \column{0.5\textwidth}
   \includegraphics<3>[width=0.7\columnwidth]{img/scoobydoo.jpg}
 \end{columns}
\end{frame}

% \againframe{recursion}

\begin{frame}[fragile]
 \frametitle{Recursion: example}
 \begin{lstlisting}
function out = mystery(a,b)
if (b == 1)
    % Base case
    out = a;
else 
    % Recursive function call
    out = a + mystery(a,b-1);
end
 \end{lstlisting}
\vskip1em \pause
\begin{itemize}
  \item What does this function do? \pause
  \item Can you spot the error? \pause
  \item How deep can you go? Which values of b don't work anymore?
\end{itemize}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Recursion: exercise}
 Create a function computing the factorial of $N$, based on recursion. \pause
 \begin{lstlisting}
function res = fact_recursive(x)

% Catch non-integer case
if (fix(x)~=x) | (x<0)
    disp 'You should provide a positive integer number only'
    return;
end

if (x > 1)
    res = x*fact_recursive(x-1);
else
    res = 1;
end

end 
 \end{lstlisting}
\end{frame}


\part{Code management}
\frame{\partpage}
\section{Coding in style}
\subsection*{Introduction}
\begin{frame}[label=contents]
  \frametitle{Today's outline}
  \mode<beamer>{
    \only<1>{\tableofcontents}
  }
  \only<2>{\tableofcontents[currentsection]}
\end{frame}

\begin{frame}
  \frametitle{If anything sticks today, let it be this}
  \begin{center}
    {\LARGE Your code will not be understood by anyone\\}
  \pause
  \vskip1em
  That includes future-you
  \vskip2em
  \end{center}
\end{frame}

\subsection*{Organization}
\begin{frame}
\frametitle{Code organization}
  \begin{itemize}
    \item Optimization of a code is time-consuming and complicated
    \item The more you optimize your code, the less readable it becomes
    \item But... You can write it in a such way that it will be flexible and easy to maintain
    \item Especially important in team work
    \item Any person has its own handwriting. Any programmer has its own coding style.
\end{itemize}
 \tikz{\node[emphblock,text width=\textwidth]{The coding style $\equiv$ handwriting...};}

\end{frame}

\begin{frame}[fragile]
 \frametitle{Interpret the following code}
 \begin{lstlisting}
s=checksc();
if(s==true)
a=cb();
b=cfrsp();
if(a<5)
if(b>5)
a=gtbs();
end
if(a>b)
ubx();
end
end
else
brn();
gtbs();
end
 \end{lstlisting}
\end{frame}

\begin{frame}[plain]
\includegraphics[keepaspectratio=true,width=\textwidth]{img/wat-2.jpg}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Let's change that a bit... Indentation}
 \pause
 Shown here with 2 spaces of indentation, Matlab uses 4 by default!
 \begin{columns}[T]
    \column{0.4\textwidth}
     \begin{lstlisting}
s=checksc();
if(s==true)
a=cb();
b=cfrsp();
if(a<5)
if(b>5)
a=gtbs();
end
if(a>b)
ubx();
end
end
else
brn();
gtbs();
end
 \end{lstlisting}
    \column{0.6\textwidth}
     \begin{lstlisting}
s = checksc();
if (s == true)
  a = cb();
  b = cfrsp();
  if (a < 5)
    if (b > 5)
      a = gtbs();
    end
    if (a > b)
      ubx();
    end
  end
else
  brn();
  gtbs();
end
 \end{lstlisting}
 \end{columns}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Readable variables and function names}
 \begin{columns}[T]
    \column{0.4\textwidth}
\begin{lstlisting}
s = checksc();
if (s == true)
  a = cb();
  b = cfrsp();
  if (a < 5)
    if (b > 5)
      a = gtbs();
    end
    if (a > b)
      ubx();
    end
  end
else
    brn();
    gtbs();
end
 \end{lstlisting}
    \column{0.6\textwidth}
     \begin{lstlisting}
IAmFree = checkSchedule();
if (IAmFree == true)
  books = countBooks();
  shelfSize = countFreeSpaceShelf();
  if (books < 5)
    if (shelfSize > 5)
      books = goToBookStore();
    end
    if (books > shelfSize)
      useBox();
    end
  end
else
  burnBooks();
  goToBookStore();
end
 \end{lstlisting}
 \end{columns}
%  \pause
%  \begin{itemize}
%   \item This style uses lowerCamelCase naming style. This is a personal preference.
%   \item Function names start with a verb; it \emph{does} something.
%  \end{itemize}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Get rid of obscure constants in the code}
 \begin{columns}[T]
    \column{0.5\textwidth}
     \begin{lstlisting}[basicstyle=\scriptsize\ttfamily]
IAmFree = checkSchedule();
if (IAmFree == true)
  books = countBooks();
  shelfSize = countFreeSpaceShelf();
  if (books < 5)
    if (shelfSize > 5)
      books = goToBookStore();
    end
    if (books > shelfSize)
      useBox();
    end
  end
else
  burnBooks();
  goToBookStore();
end
 \end{lstlisting}
    \column{0.5\textwidth}
     \begin{lstlisting}[basicstyle=\scriptsize\ttfamily,emph={minBooksNeeded,maxShelfSize},emphstyle=\color{red}]
IAmFree = checkSchedule();
if (IAmFree == true)
  books = countBooks();
  shelfSize = countFreeSpaceShelf();
  if (books < maxShelfSize)
    if (shelfSize > minBooksNeeded)
      books = goToBookStore();
    end
    if (books > shelfSize)
      useBox();
    end
  end
else
  burnBooks();
  goToBookStore();
end
 \end{lstlisting}
 \end{columns}
\end{frame}

\begin{frame}[fragile]
 \frametitle{That's more like it!}
 \begin{columns}[T]
    \column{0.3\textwidth}
     \begin{lstlisting}
s=checksc();
if(s==true)
a=cb();
b=cfrsp();
if(a<5)
if(b>5)
a=gtbs();
end
if(a>b)
ubx();
end
end
else
brn();
gtbs();
end
 \end{lstlisting}
    \column{0.7\textwidth}
     \begin{lstlisting}
IAmFree = checkSchedule();
if (IAmFree == true)
  books = countBooks();
  shelfSize = countFreeSpaceShelf();
  if (books < maxShelfSize)
    if (shelfSize > minBooksNeeded)
      books = goToBookStore();
    end
    if (books > shelfSize)
      useBox();
    end
  end
else
  burnBooks();
  goToBookStore();
end
 \end{lstlisting}
 \end{columns}
\end{frame}

\subsection*{Comments}
\begin{frame}
  \frametitle{Writing readable code}
  Good code reads like a book.\vskip2em \pause
  \begin{itemize}
    \item When it doesn't, make sure to use comments. In Matlab, everything following \lstinline$ \% is a comment$
    \item Prevent ``smart constructions'' in the code
    \item Re-use working code (i.e. create functions for well-defined tasks).
    \item Documentation is also useful, but hard to maintain.\pause\ (Matlab comes with a function that generates reports from comments)
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
 \frametitle{How not to comment}
 \begin{itemize}[<+->]
  \item Useless:
  \begin{lstlisting}
% Start program 
  \end{lstlisting}
  \item Obvious:
  \begin{lstlisting}
if (a > 5)   % Check if a is greater than 5
    ... 
end\end{lstlisting}
  \item Too much about the life:
  \begin{lstlisting}[basicstyle=\tiny\ttfamily]
% Well... I do not know how to explain what is going on
% in the snippet below. I tried to code in the night 
% with some booze and it worked then, but now I have a 
% strong hangover and some parameters still need to be
% worked out...
  \end{lstlisting}

  \item ...
  \begin{lstlisting}[basicstyle=\tiny\ttfamily]
% You may think that this function is obsolete, and doesn't seem to
% do anything. And you would be correct. But when we remove this 
% function for some reason the whole program crashes and we can't 
% figure out why, so here it will stay.
  \end{lstlisting}
 \end{itemize}
\end{frame}

\begin{frame}[fragile]
 \frametitle{Adding comments to our program}
 \begin{lstlisting}
IAmFree = checkSchedule();
if (IAmFree == true)
% Count books and amount of free space on a shelf. 
% If minimum number of books I need is less than a 
% shelf capacity, go shopping and buy additional 
% literature. If the amount of books after the 
% shopping is too big, use boxes to store them.
  books = countBooks();
  shelfSize = countFreeSpaceShelf();
  
  ...

else
  burnBooks();
  goToBookStore();
end
 \end{lstlisting}
\end{frame}

\begin{frame}
  \frametitle{If anything sticks today, let it be this}
  \begin{center}
    {\LARGE Your code will not be understood by anyone\\}
  \pause
  \vskip1em
  That includes future-you
  \vskip2em
  \end{center}
  \pause
  \tikz{\node[emphblock, text width=\textwidth]{Use comments and code to document design and purpose (functionality), not mechanics (implementation).};}
  \vskip1em\pause
  \tikz{\node[emphblock, text width=\textwidth]{Use consistent and sensible naming of functions and variables.};}
\end{frame}

\section{Error management}
\subsection*{Errors in programming}
\againframe<2>{contents}
% \begin{frame}
%  \frametitle{Errors in computer programs}
%  \begin{center}
%     Computer programs often contain errors (bugs): buildings collapse, governments fall, kittens will die.\\
%       \vskip1em
%     \includegraphics[width=0.8\textwidth]{bugFree.png}
%  \end{center}
% \end{frame}

\begin{frame}
 \frametitle{Errors in computer programs}
 \footnotesize\selectfont
 The following symptoms can be distinguished:
 \begin{itemize}
   \item Unable to execute the program
   \item Program crashes, warnings or error messages
   \item Never-ending loops
   \item Wrong (unexpected) result
 \end{itemize}
 \vskip1em
 \uncover<2->{
  Three error categories:
  \begin{description}
   \colorize<2->  \item[Syntax errors] You did not obey the language rules. These errors prevent running or compilation of the program.
   \colorize<3->  \item[Runtime errors] Something goes wrong during the execution of the program resulting in an error message (problem with input, division by zero, loading of non-existent files, memory problems, etc.)
   \colorize<4->  \item[Semantic errors] The program does not do what you expect, but does what have told it to do.
  \end{description}
 }
\end{frame}

% \begin{frame}[fragile]
%  \frametitle{Verification and validation}
%   \scriptsize\selectfont
%   \begin{columns}
%     \column{0.6\textwidth}
%     \uncover<3->{\begin{block}{Verification}
%     Verification is the process of mathematically and computationally assuring that the model computes what you have entered.    
%     \end{block}
%     }
%     \uncover<7->{
%     \begin{block}{Validation}
%       Validation is the process of determining the degree to which a model is an accurate representation of the real world from the perspective of the intended uses of the model
%     \end{block}
%     }
% 
%   \column{0.4\textwidth}
%     \begin{tikzpicture}[block/.style={rectangle,minimum size=3mm,text badly centered,drop shadow,
% 					thick,rounded corners,draw=maincolor,top color=maincolor!35,bottom color=maincolor!20,
% 					font=\sffamily\scriptsize},>=stealth,node distance=0.75cm]
% 	\node[block] (p) at (0,0) {Problem};
% 	\uncover<2->{\node[below of=p] (p1) {};
% 	\node[block, below of=p1] (mm) {Mathematical Model};
% 	\node[below of=mm] (mm1) {};}
% 	\uncover<4->{\node[block, below of=mm1] (cm) {Computational Model};
% 	\node[below of=cm] (cm1) {};}
% 	\uncover<6->{\node[block, below of=cm1] (r) {Results};}
% 	
% 	\uncover<3->{\node[block, left of=p1,node distance=2cm] (v1) {Verification};}
% 	\uncover<5->{\node[block, left of=mm1,node distance=2cm] (v2) {Verification};}
% 	\uncover<7->{\node[block, left of=cm1,node distance=2cm] (v3) {Validation};}
% 	
% 	\uncover<2->{\draw[->] (p) -> (mm);}
% 	\uncover<4->{\draw[->] (mm) -> (cm);}
% 	\uncover<6->{\draw[->] (cm) -> (r);}
% 	
% 	\uncover<3->{\draw[->] (v1) -> (p1);}
% 	\uncover<5->{\draw[->] (v2) -> (mm1);}
% 	\uncover<7->{\draw[->] (v3) -> (cm1);}
%     \end{tikzpicture}
%   \end{columns}
% 
% \end{frame}
% % 
% 
% \begin{frame}
%   \frametitle{Be aware of your uncertainties}
%   \scriptsize\selectfont
%   \begin{columns}
%     \column{0.5\textwidth}
%     \begin{center}
%       \mode<beamer>{
% 	\includegraphics<1>[width=0.8\columnwidth]{ptolemy1-1}
% 	\includegraphics<2>[width=0.8\columnwidth]{ptolemy1-2}
% 	\includegraphics<3>[width=0.8\columnwidth]{ptolemy1-3}
% 	\includegraphics<4>[width=0.8\columnwidth]{ptolemy1-4}
% 	\includegraphics<5>[width=0.8\columnwidth]{ptolemy1-5}
% 	\includegraphics<6>[width=0.8\columnwidth]{ptolemy1-6}
%       }
%       \includegraphics<7->[width=0.8\columnwidth]{ptolemy1-7}
%     \end{center}
%     \column{0.5\textwidth}
%     \begin{center}
%       \mode<beamer>{
% 	\includegraphics<7>[width=0.8\columnwidth]{ptolemy2-0}
% 	\includegraphics<8>[width=0.8\columnwidth]{ptolemy2-1}
% 	\includegraphics<9>[width=0.8\columnwidth]{ptolemy2-2}
% 	\includegraphics<10>[width=0.8\columnwidth]{ptolemy2-3}
% 	\includegraphics<11>[width=0.8\columnwidth]{ptolemy2-4}
% 	\includegraphics<12>[width=0.8\columnwidth]{ptolemy2-5}
% 	\includegraphics<13>[width=0.8\columnwidth]{ptolemy2-6}
%       }
%       \includegraphics<14>[width=0.8\columnwidth]{ptolemy2-7}
%     \end{center}
%   \end{columns}
%   \begin{itemize}
%     \item<7-> The perceived orbit of Mars from Earth shows a zig-zag (in contrast to the Sun, Mercury, Venus)
%     \item<14> Even though they were not 'right', Earth-centered models (Ptolemy) were still valid
%   \end{itemize}
% \end{frame}
% 
% \begin{frame}
%   \frametitle{Be aware of your uncertainties}
%   \vfill
%   \begin{block}{Aleatory uncertainty}
%     Uncertainty that arises due to inherent randomness of the system, features that are too complex to measure and take into account
%   \end{block}
%   \vskip1em
%   \begin{block}{Epistemic uncertainty}
%       Uncertainty that arises due to lack of knowledge of the system, but could in principle be known
%   \end{block}
%   \vfill
% \end{frame}

%  
\subsection*{Debugging}
\begin{frame}
\frametitle{A convenient tool: the debugger}
\begin{itemize}
  \colorize<1-> \item No-one can write a 1000-line code without making errors
  \begin{itemize}
    \colorize<1-> \item If you can, please come work for us
  \end{itemize}
  \colorize<2-> \item One of the most important skills you will acquire is debugging.
  \colorize<3-> \item Although it can be frustrating, debugging is one of the most intellectually rich, challenging, and interesting parts of programming.
  \colorize<4-> \item In some ways, debugging is like detective work. You are confronted with clues, and you have to infer the processes and events that led to the results you see.
\end{itemize}
\onslide<4>{
\vskip1em
\begin{raggedleft}
\emph{``When you have eliminated the impossible, whatever remains, however improbable, must be the truth.''}
\\
--- A. Conan Doyle, The Sign of Four\\ % http://www.greenteapress.com/thinkpython/html/thinkpython002.html
\end{raggedleft}
}
\end{frame}

\begin{frame}
\frametitle{A convenient tool: the debugger}
The debugger can help you to:
\begin{itemize}
  \item Pause a program at a certain line: set a \emph{breakpoint}
  \item Check the values of variables during the program
  \item Controlled execution of the program:
  \begin{itemize}
    \item One line at a time
    \item Run until a certain line
    \item Run until a certain condition is met (conditional breakpoint)
    \item Run until the current function exits
  \end{itemize}
  \item Note: You may end up in the source code of Matlab functions!\pause
  \item Check Canvas (Matlab Crash Course section) for a movie that demonstrates the debugger.
\end{itemize}
\end{frame}
% 
\begin{frame}
  \frametitle{About testcases (validation)}
  \begin{itemize}
    \item Testcases: run the program with parameters such that a known result is (should be) produced.
    \item Testcases: what happens when unforeseen input is encountered?
    \begin{itemize}
      \item More or fewer arguments than anticipated? (Matlab uses \lstinline$varargin$ and \lstinline$nargin$ to create a varying number of input arguments, and to check the number of given input arguments
      \item Other data types than anticipated? How does the program handle this? Warnings, error messages (crash), NaN or worse (a continuing program)?
    \end{itemize}
    \item For physical modeling, we typically look for analytical solutions
    \begin{itemize}
      \item Sometimes somewhat stylized cases
      \item Possible solutions include Fourier-series
      \item Experimental data
    \end{itemize}

  \end{itemize}
\end{frame}
% 
\section{Visualisation}
\subsection*{Plotting}
\againframe<2>{contents}
\begin{frame}
 \frametitle{Data visualisation}
 Modeling can lead to very large data sets, that require appropriate visualisation to convey your results.
 \begin{columns}
   \column{0.6\textwidth}
    \begin{itemize}
      \item 1D, 2D, 3D visualisation
      \item Multiple variables at the same time (temperature, concentration, direction of flow)
      \item Use of colors, contour lines
      \item Use of stream lines or vector plots
      \item Animations
    \end{itemize}
   \column{0.4\textwidth}
   \centering\includegraphics[width=\columnwidth]{visualisation}
 \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Plotting}
  \begin{lstlisting}
x = -5:0.1:5;
y = x.^2-4*x+3;
y2 = y + (2-4*rand(size(y))); (*@ \pause @*)
subplot(2,1,1); plot(x,y,'-',x,y2,'r.');
xlabel('X'); ylabel('Y'); title('Graph and Scatter'); (*@ \pause @*)
subplot(2,1,2); plot(x,abs(y-y2),'r-');
xlabel('X'); ylabel('Y'); title('Absolute error');
  \end{lstlisting}
  \centering\includegraphics[width=0.8\textwidth]{showplot-utc}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Plotting (2)}
  Easy plotting of functions can be done using the ezplot function: \lstinline$ezplot('x-sin(x)', [0 2*pi])$:
  \includegraphics[width=0.7\textwidth]{show_ezplot-utc}\\
  Be careful with steep gradients: \lstinline$ezplot('x-sin(1/x)', [0 1])$% (use \lstinline$fplot$ instead)
  \includegraphics[width=0.7\textwidth]{show_ezplot2-utc}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Other plotting tools}
  \begin{columns}
   \column{0.6\textwidth}
    \begin{itemize}[<+->]
      \item Errorbars: \lstinline$errorbar(x,y,err)$
      \item 3D-plots: \lstinline$plot3(x,y,z)$
      \item Histograms: \lstinline$histogram(x,20)$
%       \item Vectorplots: \lstinline$quiver(x,y,vx,vy)$
    \end{itemize}
   \column{0.4\textwidth}
    \includegraphics<1>[width=\columnwidth]{show_errorbar-utc}
    \includegraphics<2>[width=\columnwidth]{show_ezplot3-utc}
    \includegraphics<3>[width=\columnwidth]{show_hist-utc}
%     \includegraphics<3>[width=\columnwidth]{show_quiver-utc}
    
 \end{columns}
\end{frame}

\subsection*{Multi-dimensional data}
\begin{frame}[fragile]
  \frametitle{Multi-dimensional data}
  Matlab typically requires the definition of rectangular grid coordinates using \lstinline$meshgrid$:\\
  \begin{overlayarea}{\textwidth}{6cm}
  \begin{columns}[T]
   \column{0.6\textwidth}
    \begin{lstlisting}
[x y] = meshgrid(-2:0.1:2, -2:0.1:2);
z = x .* y .* exp(-x.^2 - y.^2);
    \end{lstlisting}
    \vskip1em
    \begin{itemize}
      \item<2-> Surface plot
      \item<3-> Contour plot
      \item<4-> Waterfall 
      \item<5> Ribbons
    \end{itemize}
   \column{0.4\textwidth}
   \begin{center}
      \includegraphics<2>[width=\columnwidth]{show_surf}
      \includegraphics<3>[width=\columnwidth]{show_contour}
      \includegraphics<4>[width=\columnwidth]{show_waterfall}
      \includegraphics<5>[width=\columnwidth]{show_ribbon}
   \end{center}
    \only<2>{
      \lstinline$surf(x,y,z);$
    }
    \only<3>{
      \lstinline$v=-0.5:0.05:0.5;$ \\
      \lstinline$contour(x,y,z,v,'ShowText', 'on');$
    }
    \only<4>{
    \lstinline$waterfall(x,y,z);$\\
    \lstinline$colormap(winter);$
    }
    \only<5>{
    \lstinline$ribbon(z);$
    }
 \end{columns}
 \end{overlayarea}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Vector data}
  The gradient operator, as expected, is used to obtain the gradient of a scalar field. Colors can be used in the background to simultaneously plot field data:
  \begin{columns}[T]
   \column{0.6\textwidth}
    \begin{lstlisting}
[x y] = meshgrid(-2:0.2:2, -2:0.2:2);
z = x .* y .* exp(-x.^2 - y.^2)
[dx dy] = gradient(z,8,8)

% Background
contourf(x,y,z,30,'LineColor','none');
colormap(hot); colorbar;

axis tight; hold on;

% Vectors
quiver(x,y,dx,dy,'k');
    \end{lstlisting}
   \column{0.4\textwidth}
   \begin{center}
      \includegraphics[width=\columnwidth]{show_vector}
    \end{center}
  \end{columns}
\end{frame}

% \section{Functions: the sequel}
% \againframe<2>{contents}
% \subsection*{Function handles}
% \begin{frame}[fragile]
%   \frametitle{Functions: revisited}
%   In MATLAB you can define your own functions to re-use certain functionalities. We now define the mathematical function $f = x^2+e^x$:
%   \begin{lstlisting}
% function y = f(x)
% y = x.^2 + exp(x);
%   \end{lstlisting}
%   \pause
%   Note:
%   \begin{itemize}
%     \item The first line of the file has to contain the \lstinline$function$ keyword
%     \item The variables used are \emph{local}. They will not be available in your Workspace
%     \item The file needs to be saved with the same name as the function, i.e. ``f.m''
%     \item The semi-colon prevents that at each function evaluation output appears on the screen
%     \item If \lstinline$x$ is an array, then \lstinline$y$ becomes an array of function values.
%   \end{itemize}
% \end{frame}

% \begin{frame}[fragile]
%   \frametitle{Anonymous functions}
%   If you do not want to create a file, you can create an \emph{anonymous function}:
%   \begin{lstlisting}
% >> f = @(x) (x.^2+exp(x))
%   \end{lstlisting}
%   \pause
%   \begin{itemize}
%     \item \lstinline$f$: the name of the function
%     \item \lstinline$@$: the function handle
%     \item \lstinline$x$: the input argument
%     \item \lstinline$x.^2+exp(x)$: the actual function
%   \end{itemize}\pause
%   \begin{lstlisting}
% >> f(0:0.1:1)   
%   \end{lstlisting}
% \end{frame}

% \begin{frame}[fragile]
%   \frametitle{Using function handles}
%   A function handle points to a function. It behaves as a variable
%   \begin{lstlisting}
% >> myFunctionHandle = @exp 
% >> myFunctionHandle(1)
%   \end{lstlisting}
%   \pause
%   Used a.o. for passing a function to another function, for instance for optimization functions.
%   \[ f(x) = x^3 -x^2 -3\arctan{x}+1 \]
%   \pause
%   Matlab offers a function \lstinline$fzero$ that can find the roots of a function in a certain range:
%   \begin{lstlisting}
% >> f = @(x) x.^3 - x.^2 - 3*atan(x) + 1;
% >> fzero(f,[-2 2])
% >> ezplot(f)
% >> f(ans)
%   \end{lstlisting}
% \end{frame}

% \begin{frame}[fragile]
%   \frametitle{Practice function handles}
%   Consider the function
%   \[ f(x) = -x^2 - 3x + 3 + e^{x^2} \]
%   The built-in Matlab function \lstinline$fminbnd$ allows to find the minimum of a function in a certain range. Find the minimum of $f(x)$ on $-2\leq x \leq2$.
%   Example usage:
%   \begin{lstlisting}
% x = fminbnd(fun,x1,x2)
%   \end{lstlisting}
%   \pause
%   Answer using an anonymous function:
%   \begin{lstlisting}
% >> f = @(x) -x.^2 - 3*x + 3 + exp(x.^2)
% >> ezplot(f,[-2 2])
% >> fminbnd(f,-2,2)
% >> f(ans)
%   \end{lstlisting}
%   \pause
%   Various related functions are \lstinline$fzero$, \lstinline$feval$, \lstinline$fsolve$, \lstinline$fminsearch$. They will be discussed later in the course.
% %   fzero
% %   feval
% %   fsolve
% %   fminsearch
% %   f
% \end{frame}

\section{Conclusions}
\subsection*{Conclusions}
\againframe<2>{contents}
\begin{frame}[fragile]
  \frametitle{In conclusion...}
  \begin{itemize}
    \colorize<1> \item Matlab: A versatile development environment, with excellent vector and matrix computations
    \colorize<2> \item Programming basics: variables, operators and functions, locality of variables, recursive operations
  \end{itemize}
  \pause
    \begin{itemize}
    \colorize<3> \item For now: exercises 1-4 (basics), 5+6 (advanced).
    \colorize<4> \item Preparation for next lecture: familiarize with the concepts, especially part 1 of these slides.
  \end{itemize}
  \pause
\end{frame}

\end{document}


% References
% http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-00sc-introduction-to-computer-science-and-programming-spring-2011/unit-1/lecture-1-introduction-to-6.00/
% http://www.greenteapress.com/thinkpython/html/thinkpython002.html
% https://www.youtube.com/channel/UCLMQ21H2ad95faYG3yGCwYA
%http://stackoverflow.com/questions/4227145/in-matlab-are-variables-really-double-precision-by-default
%http://www.exploringbinary.com/why-0-point-1-does-not-exist-in-floating-point/

