\documentclass[11pt,table,final,fleqn,xcolor={usenames,dvipsnames,table}]{beamer}
\usetheme[]{Frankfurt}
% \usecolortheme{crane}


\input{../00-settings.tex}
% 
% \usepackage{pgfpages}
% \pgfpagesuselayout{4 on 1}[border shrink=5mm]

% PRESENTATION SPECIFICS
\title{Boundary value problems}

\author[M.~Van Sint Annaland]{\underline{Martin van Sint Annaland}, Edwin Zondervan, Ivo~Roghair \\ \vskip1em {\scriptsize \underline{m.v.sintannaland@tue.nl}}}

\institute[SPI]{{Chemical Process Intensification,\\
  Process Systems Engineering,\\
  Eindhoven University of Technology}}

\date


% BEGIN PRESENTATION
\begin{document}
\sisetup{detect-all}

% \part{test}
\frame[plain]{
  \titlepage
}

\section{Solution techniques in Excel}
\begin{frame}[label=contents,nonavbar]
  \frametitle{Today's outline}
  \mode<beamer>{
    \only<1>{\tableofcontents}
  }
  \only<2>{\tableofcontents[currentsection]}
\end{frame}

\subsection{Solver and goal-seek}
\begin{frame}
  \frametitle{Solver and goal-seek}
  Excel comes with a goal-seek and solver function. For Excel 2010:
  \begin{itemize}
    \item Install via Excel $\Rightarrow$ File $\Rightarrow$ Options $\Rightarrow$ Add-Ins $\Rightarrow$ Go (at the bottom) $\Rightarrow$ Select solver add-in. You can now call the solver screen on the 'data' menu ('Oplosser' in Dutch)
    \item Select the goal-cell, and whether you want to minimize, maximize or set a certain value
    \item Enter the variable cells; Excel is going to change the values in these cells to get to the desired solution
    \item Specify the boundary conditions (e.g. to keep certain cells above zero)
    \item Click 'solve' (possibly after setting the advanced options). 
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Goal-seek: a simple example}
  Goal-Seek can be used to make the goal-cell to a specified value by changing another cell:
   \rowcolors[]{20}{white}{white}
   \renewcommand\arraystretch{1.25}
   \begin{itemize}
     \colorize<2> \item Open Excel and type the following:
    \begin{longtable}{|>{\columncolor{gray!40}}R{1cm}*{1}{|L{2cm}}*{1}{|L{4cm}}|}
    \hline
    \rowcolor{gray!40}& \centering A  & \centering B\tabularnewline
    \hline
    1 & x \hfill 	& 3  \\
    \hline
    2 & f(x) \hfill & =--3*B1\textasciicircum2--5*B1+2  \\
    \hline
    3 &  		& \\
    \hline
    \end{longtable}
    \colorize<3> \item Go to Data $\Rightarrow$ What-If Analysis $\Rightarrow$ Goal Seek...
    \begin{itemize}
      \colorize<3> \item Set cell: B2
      \colorize<3> \item To value: 0
      \colorize<3> \item By changing cell: B1
    \end{itemize}
    \colorize<4> \item OK. You find a solution of $0.333\ldots$.
   \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Solver: a simple example}
  The solver is used to change the value in a goal-cell, by changing the values in 1 or more other cells while keeping boundary conditions:
   \rowcolors[]{20}{white}{white}
   \renewcommand\arraystretch{1.25}
   \begin{itemize}
    \colorize<2> \item Use the following sheet:
    \begin{longtable}{|>{\columncolor{gray!40}}R{1cm}*{1}{|L{2cm}}*{1}{|L{2cm}}*{1}{|L{3cm}}|}
    \hline
    \rowcolor{gray!40}& \centering A  & \centering B& \centering C \tabularnewline
    \hline
    1 & & x	& f(x)  \\
    \hline
    2 & x1 \hfill & 3 & =2*B2*B3--B3+2 \\
    \hline
    3 & x2 & 4& =2*B3--4*B2-4 \\
    \hline
    \end{longtable}
    \colorize<3> \item Go to Data $\Rightarrow$ Solver
    \begin{itemize}
      \colorize<3> \item Goalfunction: C1 (value of: 0)
      \colorize<3> \item Add boundary condition: C2 = 0
      \colorize<3> \item By changing cells: \$B\$1:\$B\$2 (you can just select the cells)
    \end{itemize}
    \colorize<4> \item Solve. You will find B1=0 and B2=2.
   \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Exercise}
  \footnotesize\selectfont
  Use Excel functions to obtain the Antoine coefficients $A$, $B$ and $C$ for carbon monoxide following the equation:
  \[
    \ln P = A - \frac{B}{T+C}
  \]
  $P$ in \si{\pascal}, $T$ in \si{\kelvin}. Experimental data is given:
  \begin{columns}
  \column{0.35\textwidth}
    \begin{longtable}{c|r}
      $P$ [\si{\mmHg}]& $T$ [\si{\celsius}] \\ \hline
      1	&-222.0\\
      5	&-217.2\\
      10	&-215.0\\
      20	&-212.8\\
      40	&-210.0\\
      60	&-208.1\\
      100	&-205.7\\
      200	&-201.3\\
      400	&-196.3\\
      760	&-191.3\\ \hline
    \end{longtable}
  \column{0.65\textwidth}
  \onslide<2->{
    \begin{enumerate}
      \item Dedicate three separate cells for $A$, $B$ and $C$. Give an initial guess \pause
      \item Convert all values to proper units (hint: use e.g. =CONVERT(A2,``mmHg'',``Pa''))\pause
      \item Compute $\ln P_\text{exp}$ and $\ln P_\text{corr}$\pause
      \item Compute $(\ln P_\text{exp} - \ln P_\text{corr})^2$, and sum this column\pause
      \item Start the solver, and minimize the sum by changing cells for $A$, $B$ and $C$.\pause
    \end{enumerate}}
  \end{columns}
\end{frame}

\section{Boundary value problems}
\begin{frame}
  \frametitle{What is an ODE?}
  \begin{itemize}
    \item Algebraic equation:
    \[
      f(y(x),x) = 0 \qquad \text{e.g.} \, -\ln(K_{eq})=(1-\zeta)
    \]
    \item First order ODE:
    \[
      f\left(\frac{dy}{dx}(x),y(x),x\right) = 0 \quad \text{e.g.} \, \frac{dc}{dt} = -kc^n
    \]
    \item Second order ODE:
    \[
      f\left(\frac{d^2y}{dx^2}(x),\frac{dy}{dx}(x),y(x),x \right) = 0 \quad \text{e.g.} \quad \mathcal{D}\frac{d^2c}{dx^2}= - \frac{kc}{1+Kc}
    \]
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{About second order ODEs}
  Very often a second order ODE can be rewritten into a system of first order ODEs (whether it is handy depends on the boundary conditions!)
  \vskip1em
  \pause
  \begin{block}{In general}
  Consider the second order ODE:
  \[
    \frac{d^2y}{dx^2} + q(x)\frac{dy}{dx} = r(x)
  \]
  Now define and solve using $z$ as a new variable:
  \begin{align*}
    \frac{dy}{dx} &= z(x) \\
    \frac{dz}{dx} &= r(x) - q(x)z(x)
  \end{align*}
  \end{block}
\end{frame}

\begin{frame}
  \frametitle{Importance of boundary conditions}
  \footnotesize\selectfont
  The nature of boundary conditions determines the appropriate numerical method. Classification into 2 main categories:
  \begin{itemize}
    \item \emph{Initial value problems (IVP)} \\
    We know the values of all $y_i$ at some starting position $x_s$, and it is desired to find the values of $y_i$ at some final point $x_f$. \vskip1em
    \begin{center}
      \begin{tikzpicture}[scale=5]
        \node[] (y1s) at (0,0.1) {$y_{1,s}$};
        \node[] (y1f) at (1,0.1) {\color{tuered}$y_{1,f}$};
        \node[] (y2s) at (0,0) {$y_{2,s}$};
        \node[] (y2f) at (1,0) {\color{tuered}$y_{2,f}$};
        \node[fdot] (xs) at (0,-0.1) {};
        \node[fdot] (xf) at (1,-0.1) {};
        \node[anchor=north] at (xs.south) {$x_s$};
        \node[anchor=north] at (xf.south) {$x_f$};
        \draw[line] (xs) -- (xf);
        \draw[line,->,densely dashed] (0.1,0.05) -- node[midway,above] {``Marching''} (0.9,0.05);
      \end{tikzpicture}
    \end{center}
    \item \emph{Boundary value problems (BVP)} \\
    Boundary conditions are specified at more than one $x$. Typically, some of the BC are specified at $x_s$ and the remainder at $x_f$. \vskip1em
    \centering
    \begin{tikzpicture}[scale=5]
      \node[] (y1s) at (0,0.1) {$y_{1,s}$};
      \node[] (y1f) at (1,0.1) {\color{tuered}$y_{1,f}$};
      \node[] (y2s) at (0,0) {\color{tuered}$y_{2,s}$};
      \node[] (y2f) at (1,0) {$y_{2,f}$};
      \node[fdot] (xs) at (0,-0.1) {};
      \node[fdot] (xf) at (1,-0.1) {};
      \node[anchor=north] at (xs.south) {$x_s$};
      \node[anchor=north] at (xf.south) {$x_f$};
      \draw[line] (xs) -- (xf);
      \draw[line,->,densely dashed] (0.1,0.05) -- node[midway,above] {``Shooting''} (0.9,0.05);
      
      \coordinate[] (b) at ($(y1f)!0.5!(y2f) + (0.1,0) $) {};
      \coordinate[right of=b] (c1) {};
      \coordinate[below=1.4cm] (c2) at (c1)  {};
%       \coordinate[below of=1cm] at (c2) (c5) {};

      \coordinate[] (s) at ($(y1s)!0.5!(y2s) - (0.1,0) $) {};
      \coordinate[left of=s] (c3) {};
      \coordinate[below=1.4cm] (c4) at (c3)  {};
%       \coordinate[below of=c4] (c6) {};

%       \node[] (b) at ($(y1f)!0.5!(y2f)$) {};
      \draw[line,->,densely dashed,draw=tuegreen,rounded corners=10pt] (b) -- (c1) -- (c2) -- (c4) -- (c3) -- (s);
%       \draw[line,densely dashed,draw=tuegreen] (y2f) to [controls=(1,-0.2) and +(-0.1,-0.2)] (y2s);
    \end{tikzpicture}
  \end{itemize}
\end{frame}



\end{document}

% can be obtained via an analytical solution:
%       $\displaystyle q = k_L E_A C_{A,i,L} \quad$ with \begin{minipage}{0.7\textwidth}
%       \begin{align*}
% 	E_A &= \frac{\mathit{Ha}}{\tanh \mathit{Ha}} &\quad \text{(Activation energy)} \\
% 	\mathit{Ha} &= \frac{\sqrt{k_R\mathcal{D}}}{k_L} &\quad \text{(Hatta number)} \\
% 	k_L &= \frac{\mathcal{D}}{\delta} &\quad \text{(mass transfer coefficient)}
%       \end{align*}
%     \end{minipage}

% References
% http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-00sc-introduction-to-computer-science-and-programming-spring-2011/unit-1/lecture-1-introduction-to-6.00/
% http://www.greenteapress.com/thinkpython/html/thinkpython002.html
% https://www.youtube.com/channel/UCLMQ21H2ad95faYG3yGCwYA
%http://stackoverflow.com/questions/4227145/in-matlab-are-variables-really-double-precision-by-default
%http://www.exploringbinary.com/why-0-point-1-does-not-exist-in-floating-point/

